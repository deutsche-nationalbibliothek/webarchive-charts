apiVersion: v1
kind: ConfigMap
metadata:
  name: wapmh-query-collection-configmap
data:
  allHeadersSelect.rq: |
    prefix bibo: <http://purl.org/ontology/bibo/>
    prefix dc: <http://purl.org/dc/elements/1.1/>
    prefix rdau: <http://rdaregistry.info/Elements/u/>
    prefix dcterms: <http://purl.org/dc/terms/>
    prefix lv:   <http://purl.org/lobid/lv#>
    prefix bf: <http://id.loc.gov/ontologies/bibframe/>
    select ?identifier ?datestamp {
        ?resourceIri
            dcterms:medium <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60048 <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60049 <http://rdaregistry.info/termList/RDAContentType/1020> ;
            rdau:P60050 <http://rdaregistry.info/termList/RDAMediaType/1003> ;
            dcterms:isPartOf ?work ;
            bibo:issue ?datestamp ;
            dc:identifier ?identifier .
        filter(substr(?identifier, 1, 1) != "(")
    }
  dateRangeHeadersSelect.rq: |
    prefix bibo: <http://purl.org/ontology/bibo/>
    prefix dc: <http://purl.org/dc/elements/1.1/>
    prefix rdau: <http://rdaregistry.info/Elements/u/>
    prefix dcterms: <http://purl.org/dc/terms/>
    prefix lv:   <http://purl.org/lobid/lv#>
    prefix bf: <http://id.loc.gov/ontologies/bibframe/>
    select ?identifier ?datestamp {
        ?resourceIri
            dcterms:medium <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60048 <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60049 <http://rdaregistry.info/termList/RDAContentType/1020> ;
            rdau:P60050 <http://rdaregistry.info/termList/RDAMediaType/1003> ;
            dcterms:isPartOf ?work ;
            bibo:issue ?datestamp ;
            dc:identifier ?identifier .
        filter(
            !bound(?from) || xsd:dateTime(
                concat(?datestamp, "T00:00:00Z")
            ) >= xsd:dateTime(
                concat(?from, "T00:00:00Z")
            )
        )
        filter(
            !bound(?until) || xsd:dateTime(
                concat(?datestamp, "T00:00:00Z")
            ) <= xsd:dateTime(
                concat(?until, "T00:00:00Z")
            )
        )
        filter(substr(?identifier, 1, 1) != "(")
    }
  recordConstruct.rq: |
    prefix foaf: <http://xmlns.com/foaf/0.1/>
    prefix bibo: <http://purl.org/ontology/bibo/>
    prefix dc: <http://purl.org/dc/elements/1.1/>
    prefix rdau: <http://rdaregistry.info/Elements/u/>
    prefix dcterms: <http://purl.org/dc/terms/>
    prefix lv:   <http://purl.org/lobid/lv#>
    prefix bf: <http://id.loc.gov/ontologies/bibframe/>

    construct {
        ?resourceIri a lv:ArchivedWebPage ;
            dcterms:medium <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60048 <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60049 <http://rdaregistry.info/termList/RDAContentType/1020> ;
            rdau:P60050 <http://rdaregistry.info/termList/RDAMediaType/1003> ;
            dc:identifier ?identifier ;
            bibo:issue ?datestamp ;
            dcterms:isPartOf ?work ;
            ?p ?o .
            ?work ?wp ?wo ;
                foaf:primaryTopic ?url .
    } where {
        ?resourceIri
            dcterms:medium <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60048 <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60049 <http://rdaregistry.info/termList/RDAContentType/1020> ;
            rdau:P60050 <http://rdaregistry.info/termList/RDAMediaType/1003> ;
            dc:identifier ?identifier ;
            bibo:issue ?datestamp ;
            dcterms:isPartOf ?work ;
            ?p ?o .
            ?work ?wp ?wo ;
                foaf:primaryTopic ?url .
    }
  recordOaiDcConstruct.rq: |
    prefix foaf: <http://xmlns.com/foaf/0.1/>
    prefix bibo: <http://purl.org/ontology/bibo/>
    prefix dc: <http://purl.org/dc/elements/1.1/>
    prefix rdau: <http://rdaregistry.info/Elements/u/>
    prefix dcterms: <http://purl.org/dc/terms/>
    prefix lv:   <http://purl.org/lobid/lv#>
    prefix bf: <http://id.loc.gov/ontologies/bibframe/>

    construct {
        ?resourceIri
            dc:type <http://rdaregistry.info/termList/RDACarrierType/1018>, <http://rdaregistry.info/termList/RDAContentType/1020>, <http://rdaregistry.info/termList/RDAMediaType/1003> ;
            dc:identifier ?resourceIri, ?identifier ;
            dc:date ?datestamp ;
            dc:relation ?work, ?workIdentifier ;
            dc:subject ?url ; # could also be the link to the WARC file
            # dc:format "application/warc" ;
            dc:source ?url .
    } where {
        ?resourceIri
            dcterms:medium <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60048 <http://rdaregistry.info/termList/RDACarrierType/1018> ;
            rdau:P60049 <http://rdaregistry.info/termList/RDAContentType/1020> ;
            rdau:P60050 <http://rdaregistry.info/termList/RDAMediaType/1003> ;
            dc:identifier ?identifier ;
            bibo:issue ?datestamp ;
            dcterms:isPartOf ?work .
        ?work foaf:primaryTopic ?url .
        optional {
            ?work dc:identifier ?workIdentifier
        }
    }